---
title: "webhacking.kr 6ë²ˆ ë¬¸ì œ"
date: 2019-10-19
excerpt: "base64"
categories : "webhacking"
comments: true
header:
    image: /assets/images/webhacking06image.jpg
    teaser: "https://raw.githubusercontent.com/TERADA-DANTE/TERADA-DANTE.github.io/master/_images/teaser/webhacking_teaser.jpg"

toc: true 
toc_label: "ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ..." 
toc_icon: "chess-rook"
toc_sticky: true
---

## ê°œìš”
ì´ë²ˆ í¬ìŠ¤íŠ¸ëŠ” webhacking.kr 6ë²ˆ ë¬¸ì œì…ë‹ˆë‹¤. ë°°ì ì€ 100ì ì…ë‹ˆë‹¤.

í˜ì´ì§€ì˜ ì²« í™”ë©´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![6_1](https://i.imgur.com/H6uXNbY.png)

view-sourceë¥¼ í´ë¦­í•˜ì—¬ ì†ŒìŠ¤ì½”ë“œğŸ“°ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`view-source`

~~~php
...
if(!$_COOKIE['user']){
  $val_id="guest";
  $val_pw="123qwe";
  for($i=0;$i<20;$i++){
    $val_id=base64_encode($val_id);
    $val_pw=base64_encode($val_pw);
  }
  $val_id=str_replace("1","!",$val_id);
  $val_id=str_replace("2","@",$val_id);
    ...
  $val_pw=str_replace("7","(",$val_pw);
  $val_pw=str_replace("8",")",$val_pw);
  
  Setcookie("user",$val_id,time()+86400,"/challenge/web-06/");
  Setcookie("password",$val_pw,time()+86400,"/challenge/web-06/");
...
<?php
$decode_id=$_COOKIE['user'];
$decode_pw=$_COOKIE['password'];

$decode_id=str_replace("!","1",$decode_id);
$decode_id=str_replace("@","2",$decode_id);
...
$decode_pw=str_replace("(","7",$decode_pw);
$decode_pw=str_replace(")","8",$decode_pw);

for($i=0;$i<20;$i++){
  $decode_id=base64_decode($decode_id);
  $decode_pw=base64_decode($decode_pw);
}

echo("<hr><a href=./?view_source=1 style=color:yellow;>view-source</a><br><br>");
echo("ID : $decode_id<br>PW : $decode_pw<hr>");

if($decode_id=="admin" && $decode_pw=="nimda"){
  solve(6);
}
?>
...
~~~

ì†ŒìŠ¤ì½”ë“œê°€ ê¸¸ì–´ ì¤‘ê°„ì¤‘ê°„ ìƒëµí–ˆìŠµë‹ˆë‹¤. ì „ì²´ì ìœ¼ë¡œ ë³´ë©´ ë¬¸ìì—´ì„ ì¹˜í™˜í•˜ê±°ë‚˜, encode, decode ê³¼ì •ì„ í†µí•´ ë¬¸ìì—´ì„ ë³€í˜•ì‹œí‚¤ê³ ìˆìŠµë‹ˆë‹¤. line 32~34ë¥¼ ë³´ë©´ **ë¬¸ì œì˜ ëª©í‘œ**ëŠ” `$decode_id`ë¥¼ admin, `$decode_pw`ë¥¼ nimdaë¡œ ì„¤ì •í•˜ì—¬ solve(6)ì´ ì‹¤í–‰ë˜ê²Œ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. 

ë¶„ì„ì—ì„œëŠ” [í’€ì´](#í’€ì´)ì— ì•ì„œ ì†ŒìŠ¤ì½”ë“œì— ì‚¬ìš©ëœ í•¨ìˆ˜ì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤. 

## ë¶„ì„
### base64_encode()

<a class="PHP">PHP</a><a class="PHPver">7.0</a>  

base64_encode()ëŠ” dataë¥¼ base64 ì¸ì½”ë”©í•©ë‹ˆë‹¤.

#### base64_encode() ë¬¸ë²•

~~~php
base64_encode ( string $data );
~~~

`$data`: base64 ì¸ì½”ë”©í•  data

#### base64_encode() ì˜ˆì œ
~~~php
$str = 'This is an encoded string';
echo base64_encode($str);   
// VGhpcyBpcyBhbiBlbmNvZGVkIHN0cmluZw==
~~~

### str_replace()

<a class="PHP">PHP</a><a class="PHPver">7.0</a>  


str_replaceëŠ” ì¼ì¹˜í•˜ëŠ” **ëª¨ë“ ** ë¬¸ìì—´ì„ ì°¾ì•„ë‚´ì–´, ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ ì¹˜í™˜(replace)í•©ë‹ˆë‹¤.

#### str_replace() ë¬¸ë²•
~~~php
str_replace ( 
    mixed $search , mixed $replace , mixed $subject [, int &$count ] )
~~~

`$search`: `$subject` ë‚´ì˜ ì°¾ì„ ë¬¸ìì—´

`$replace`: í•¨ìˆ˜ ì‹¤í–‰ í›„ ì¹˜í™˜**ë ** ë¬¸ìì—´

`$subject`: ëŒ€ìƒ ë¬¸ìì—´

#### str_replace() ì˜ˆì œ
~~~php
$str1 = "Nothing is impossible";
$str2 = str_replace("Nothing", "Something", $str1);
echo ($str2);   // "Something is impossible"
~~~

### base64_decode()

<a class="PHP">PHP</a><a class="PHPver">7.0</a>  

base64_decode()ëŠ” dataë¥¼ base64 ë””ì½”ë”©í•©ë‹ˆë‹¤.

#### base64_decode() ë¬¸ë²•

~~~php
base64_decode ( string $data );
~~~
`$data`: base64 ì¸ì½”ë”©ëœ data

#### base64_decode() ì˜ˆì œ

~~~php
$str = 'VGhpcyBpcyBhbiBlbmNvZGVkIHN0cmluZw==';
echo base64_decode($str);
// This is an encoded string
~~~

## í’€ì´
6ë²ˆ ë¬¸ì œì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ë¶„ì„í•˜ì—¬ ë„ì‹í™”í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. 

![6_2](https://i.imgur.com/8XKGEoQ.png)

í˜ì´ì§€ì— ì ‘ì†í•˜ë©´ ìë™ì ìœ¼ë¡œ $val_id = 'guest', $val_pw='123qwe'ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ì´ ê°’ì´ base64_encdoeì™€ str_replace ê±°ì³ COOKIEë¡œ ì €ì¥ë˜ì—ˆê³ , ì‹¤ì œë¡œ í˜ì´ì§€ì˜ COOKIEğŸªë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì €ì¥ë˜ì–´ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

![6_3](https://i.imgur.com/jmnTSvE.png)

ê²°êµ­ ìš°ë¦¬ì˜ ëª©í‘œëŠ” STEP 5ì—ì„œ 

1. $decode_id = `admin`
2. $decode_pw = `nimda` 

ê°€ ë˜ë„ë¡ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” STEP 3ì—ì„œì˜ ì¿ í‚¤ğŸªë¥¼ ë³€ì¡°í•˜ë©´ ë©ë‹ˆë‹¤. 
ê°€ë ¹ STEP 1ì—ì„œ 

1. $val_id = `admin`
2. $val_pw = `nimda`

ë¼ê³  í•œë‹¤ë©´, STEP 2ì—ì„œëŠ”

1. $val_id = `Vm0wd2Q...Q==`
2. $val_pw = `Vm0wd2Q...Q==`

ê°€ ë ê²ƒì…ë‹ˆë‹¤. ê°’ì´ ë„ˆë¬´ ê¸¸ì–´ì„œ ì¤‘ê°„ì€ ìƒëµí•˜ì˜€ì§€ë§Œ ë‘ ê°’ì€ ë‹¤ë¦…ë‹ˆë‹¤! ê·¸ë¦¬ê³  ì´ ê°’ë“¤ì€ STEP 3ì—ì„œ 

1. $val_id = `Vm0wd@Q...Q==`
2. $val_pw = `Vm0wd@Q...Q==`

ë¡œ ì €ì¥ë  ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì´ ê²°êµ­ STEP 5ì—ì„œ `admin`ê³¼ `nimda`ë¡œ ì¸ì‹ë  ê²ƒì…ë‹ˆë‹¤. 

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” STEP 3ì—ì„œ `admin`ê³¼ `nimda`ë¥¼ ê°ê° 20ë²ˆ base64 encode í›„ str_replaceí•œ ê°’ìœ¼ë¡œ ì¿ í‚¤ğŸªë¥¼ ë³€ì¡°í•´ì£¼ë©´ 6ë²ˆë¬¸ì œëŠ” í´ë¦¬ì–´ğŸ’¯ë©ë‹ˆë‹¤.

## ë§ˆì¹˜ë©°
Javascriptì—ì„œ base64 encdoeì™€ decodeëŠ” ê°ê° btoa(), atoa() ì…ë‹ˆë‹¤. ë˜í•œ PHPì˜ str_replaceëŠ” í•´ë‹¹ë˜ëŠ” **ëª¨ë“ ** ë¬¸ìë¥¼ ì¹˜í™˜í•˜ì§€ë§Œ Javascriptì˜ replaceëŠ” í•´ë‹¹ë˜ëŠ” **ì²« ë²ˆì§¸** ë¬¸ìë¥¼ ì¹˜í™˜í•©ë‹ˆë‹¤.

----

<style>
blockquote{
    border-left: 0.25em solid #266477;
}
</style>
<style>
.page__content h1,
.page__content h2
{
    padding-bottom: 0.5em;
    border-bottom: 1px solid #89ddff;
}
</style>

<style>
    p{
        margin-block-start: 0em;
        margin-block-end: 0em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        margin-top:0px;
        margin-bottom: 0px;
    }
</style>
<style>
        .MySQL {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #52809c;
            color: #f8fafc;
            border-top-left-radius: 3px;
            border-bottom-left-radius: 3px;
            content: "MySQL"
        }

        .MySQLver {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #f8981d;
            color: #f8fafc;
            border-top-right-radius: 3px;
            border-bottom-right-radius: 3px;
        }
</style>
<style>
        .Javascript {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #f2e21b;
            color: #222;
            border-top-left-radius: 3px;
            border-bottom-left-radius: 3px;
        }

        .Javascriptver {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #000000c7;
            color: #f8fafc;
            border-top-right-radius: 3px;
            border-bottom-right-radius: 3px;
        }
</style>
<style>
        .PHP {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #777bb3;
            color: #f8fafc;
            border-top-left-radius: 3px;
            border-bottom-left-radius: 3px;
            content: "MySQL"
        }

        .PHPver {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #000000c7;
            color: #f8fafc;
            border-top-right-radius: 3px;
            border-bottom-right-radius: 3px;
        }
</style>
<style>
        .Python {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #0277bd;
            color: #f8fafc;
            border-top-left-radius: 3px;
            border-bottom-left-radius: 3px;
        }

        .Pythonver {
            display: inline;
            padding-left: 5px;
            padding-right: 5px;
            padding-top: 1px;
            padding-bottom: 2px;
            font-size: 0.6em;
            text-align: center;
            background-color: #ffc107;
            color: #f8fafc;
            border-top-right-radius: 3px;
            border-bottom-right-radius: 3px;
        }
</style>
<style>
.page h1:before {
    padding-right: 0.3em;
    color: #9ddcff;
    content: "/";
}

.page h2:before {
    padding-right: 0.3em;
    color: #9ddcff;
    content: "//";
}

.page h3:before {
    padding-right: 0.3em;
    color: #9ddcff;
    content: "///";
}

.page h4:before {
    padding-right: 0.3em;
    color: #9ddcff;
    content: "////";
}

p>code,
a>code,
li>code,
figcaption>code,
td>code {
    padding-left: 0.18rem;
    padding-right: 0.18rem;
    padding-top: 0.09rem;
    font-size: 0.8em;
    background: #fff;
    color: #5283f3;
    border: solid 1px #e1e4e5;
    border-radius: 0px;
    font-family: open sans,clear sans,helvetica neue,Helvetica,Arial,sans-serif;
    font-weight: bold;
}
</style>
